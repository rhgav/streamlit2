System.register("chunks:///_virtual/CameraFollow.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,o,r,i,a,s,n;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.initializerDefineProperty},function(e){r=e.cclegacy,i=e.Node,a=e.Vec3,s=e._decorator,n=e.Component}],execute:function(){var c,l,u,p,h,d,f;r._RF.push({},"b2cdc85AoREGL/Wg2FMPb2w","CameraFollow",void 0);const{ccclass:m,property:b}=s;e("CameraFollow",(c=m("CameraFollow"),l=b(i),u=b(a),c((d=t((h=class extends n{constructor(...e){super(...e),o(this,"characterNode",d,this),o(this,"offset",f,this)}start(){this.characterNode&&this.updateCameraPosition()}update(e){this.characterNode&&this.updateCameraPosition()}updateCameraPosition(){const e=this.characterNode.getWorldPosition(),t=new a(e.x+this.offset.x,e.y+this.offset.y,e.z+this.offset.z);this.node.setWorldPosition(t)}}).prototype,"characterNode",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=t(h.prototype,"offset",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new a}}),p=h))||p));r._RF.pop()}}}));

System.register("chunks:///_virtual/debug-view-runtime-control.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,s,l,r,h,g,a,c,p,C,d,m;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.initializerDefineProperty},function(t){i=t.cclegacy,n=t.Node,s=t._decorator,l=t.Component,r=t.Color,h=t.Canvas,g=t.UITransform,a=t.instantiate,c=t.Label,p=t.RichText,C=t.Toggle,d=t.Button,m=t.director}],execute:function(){var u,L,M,b,T,f,x,S,E;i._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);const{ccclass:v,property:I}=s;t("DebugViewRuntimeControl",(u=v("internal.DebugViewRuntimeControl"),L=I(n),M=I(n),b=I(n),u((x=e((f=class extends l{constructor(...t){super(...t),o(this,"compositeModeToggle",x,this),o(this,"singleModeToggle",S,this),o(this,"EnableAllCompositeModeButton",E,this),this._single=0,this.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],this.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],this.strMisc=["CSM Layer Coloration","Lighting With Albedo"],this.compositeModeToggleList=[],this.singleModeToggleList=[],this.miscModeToggleList=[],this.textComponentList=[],this.labelComponentList=[],this.textContentList=[],this.hideButtonLabel=void 0,this._currentColorIndex=0,this.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],this.color=[r.WHITE,r.BLACK,r.RED,r.GREEN,r.BLUE]}start(){if(!this.node.parent.getComponent(h))return void console.error("debug-view-runtime-control should be child of Canvas");const t=this.node.parent.getComponent(g),e=.5*t.width,o=.5*t.height;let i=.1*e-e,n=o-.1*o;const s=this.node.getChildByName("MiscMode"),l=a(s);l.parent=this.node,l.name="Buttons";const m=a(s);m.parent=this.node,m.name="Titles";for(let t=0;t<2;t++){const e=a(this.EnableAllCompositeModeButton.getChildByName("Label"));e.setPosition(i+(t>0?450:150),n,0),e.setScale(.75,.75,.75),e.parent=m;const o=e.getComponent(c);o.string=t?"----------Composite Mode----------":"----------Single Mode----------",o.color=r.WHITE,o.overflow=0,this.labelComponentList[this.labelComponentList.length]=o}n-=20;let u=0;for(let t=0;t<this.strSingle.length;t++,u++){t===this.strSingle.length>>1&&(i+=200,u=0);const e=t?a(this.singleModeToggle):this.singleModeToggle;e.setPosition(i,n-20*u,0),e.setScale(.5,.5,.5),e.parent=this.singleModeToggle.parent;const o=e.getComponentInChildren(p);o.string=this.strSingle[t],this.textComponentList[this.textComponentList.length]=o,this.textContentList[this.textContentList.length]=o.string,e.on(C.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[t]=e}i+=200,this.EnableAllCompositeModeButton.setPosition(i+15,n,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(d.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=l;let L=this.EnableAllCompositeModeButton.getComponentInChildren(c);this.labelComponentList[this.labelComponentList.length]=L;const M=a(this.EnableAllCompositeModeButton);M.setPosition(i+90,n,0),M.setScale(.5,.5,.5),M.on(d.EventType.CLICK,this.changeTextColor,this),M.parent=l,L=M.getComponentInChildren(c),L.string="TextColor",this.labelComponentList[this.labelComponentList.length]=L;const b=a(this.EnableAllCompositeModeButton);b.setPosition(i+200,n,0),b.setScale(.5,.5,.5),b.on(d.EventType.CLICK,this.hideUI,this),b.parent=this.node.parent,L=b.getComponentInChildren(c),L.string="Hide UI",this.labelComponentList[this.labelComponentList.length]=L,this.hideButtonLabel=L,n-=40;for(let t=0;t<this.strMisc.length;t++){const e=a(this.compositeModeToggle);e.setPosition(i,n-20*t,0),e.setScale(.5,.5,.5),e.parent=s;const o=e.getComponentInChildren(p);o.string=this.strMisc[t],this.textComponentList[this.textComponentList.length]=o,this.textContentList[this.textContentList.length]=o.string;e.getComponent(C).isChecked=!!t,e.on(C.EventType.TOGGLE,t?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[t]=e}n-=150;for(let t=0;t<this.strComposite.length;t++){const e=t?a(this.compositeModeToggle):this.compositeModeToggle;e.setPosition(i,n-20*t,0),e.setScale(.5,.5,.5),e.parent=this.compositeModeToggle.parent;const o=e.getComponentInChildren(p);o.string=this.strComposite[t],this.textComponentList[this.textComponentList.length]=o,this.textContentList[this.textContentList.length]=o.string,e.on(C.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[t]=e}}isTextMatched(t,e){let o=new String(t);const i=o.search(">");return-1===i?t===e:(o=o.substr(i+1),o=o.substr(0,o.search("<")),o===e)}toggleSingleMode(t){const e=m.root.debugView,o=t.getComponentInChildren(p);for(let t=0;t<this.strSingle.length;t++)this.isTextMatched(o.string,this.strSingle[t])&&(e.singleMode=t)}toggleCompositeMode(t){const e=m.root.debugView,o=t.getComponentInChildren(p);for(let i=0;i<this.strComposite.length;i++)this.isTextMatched(o.string,this.strComposite[i])&&e.enableCompositeMode(i,t.isChecked)}toggleLightingWithAlbedo(t){m.root.debugView.lightingWithAlbedo=t.isChecked}toggleCSMColoration(t){m.root.debugView.csmLayerColoration=t.isChecked}enableAllCompositeMode(t){const e=m.root.debugView;e.enableAllCompositeMode(!0);for(let t=0;t<this.compositeModeToggleList.length;t++){this.compositeModeToggleList[t].getComponent(C).isChecked=!0}let o=this.miscModeToggleList[0].getComponent(C);o.isChecked=!1,e.csmLayerColoration=!1,o=this.miscModeToggleList[1].getComponent(C),o.isChecked=!0,e.lightingWithAlbedo=!0}hideUI(t){const e=this.node.getChildByName("Titles"),o=!e.active;this.singleModeToggleList[0].parent.active=o,this.miscModeToggleList[0].parent.active=o,this.compositeModeToggleList[0].parent.active=o,this.EnableAllCompositeModeButton.parent.active=o,e.active=o,this.hideButtonLabel.string=o?"Hide UI":"Show UI"}changeTextColor(t){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(let t=0;t<this.textComponentList.length;t++)this.textComponentList[t].string=this.strColor[this._currentColorIndex]+this.textContentList[t]+"</color>";for(let t=0;t<this.labelComponentList.length;t++)this.labelComponentList[t].color=this.color[this._currentColorIndex]}onLoad(){}update(t){}}).prototype,"compositeModeToggle",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=e(f.prototype,"singleModeToggle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(f.prototype,"EnableAllCompositeModeButton",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=f))||T));i._RF.pop()}}}));

System.register("chunks:///_virtual/DialogueManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,o,n,a,r,l,s,c,h,u,g,p,d,m;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.initializerDefineProperty},function(e){o=e.cclegacy,n=e.TextAsset,a=e.Label,r=e.Button,l=e.Node,s=e.Sprite,c=e._decorator,h=e.Component,u=e.instantiate,g=e.Layout,p=e.resources,d=e.SpriteFrame,m=e.director}],execute:function(){var b,f,v,D,I,y,B,w,C,L,S,N,$,A,x,z,T,M,F,k,_,E,q,H,K,O,P,R,V;o._RF.push({},"f50e1qqu8dG7qXdqHrMK/Il","DialogueManager",void 0);const{ccclass:W,property:j}=c;e("DialogueManager",(b=W("DialogueManager"),f=j(n),v=j(a),D=j(a),I=j(a),y=j(a),B=j(r),w=j(r),C=j(l),L=j(l),S=j(s),N=j(s),$=j(s),A=j({type:Number,tooltip:"打字速度，单位：毫秒/字符"}),b((T=t((z=class extends h{constructor(...e){super(...e),i(this,"csvAsset",T,this),i(this,"dialogueLabel",M,this),i(this,"leftNameLabel",F,this),i(this,"rightNameLabel",k,this),i(this,"middleNameLabel",_,this),i(this,"startButton",E,this),i(this,"nextButton",q,this),i(this,"choicesContainer",H,this),i(this,"choiceButtonTemplate",K,this),i(this,"dialogueImage",O,this),i(this,"spriteA",P,this),i(this,"spriteB",R,this),i(this,"typingSpeed",V,this),this.currentDialogueId=1,this.dialogueData=[],this.isTyping=!1,this.typingInterval=null,this.imageMapping={1:"图片1",2:"图片2",3:"图片3",4:"图片4",5:"图片5",6:"图片6",7:"图片7",8:"图片8",9:"图片9",10:"图片10",11:"图片11",12:"图片12",13:"图片13",14:"图片14",15:"图片15",16:"图片16",17:"图片17",18:"图片18",19:"图片19",20:"图片20",21:"图片21",22:"图片22",23:"图片23",24:"图片24",25:"图片25",26:"图片26",27:"图片27",28:"图片28",29:"图片29"}}start(){this.startButton.node.on("click",this.onStartButtonClick,this),this.nextButton.node.on("click",this.onNextDialogue,this),this.node.active=!1,this.loadDialogueData()}loadDialogueData(){if(this.csvAsset)try{const e=this.csvAsset.text;if(!e)throw new Error("CSV 数据为空");const t=e.split("\n"),i=t[0].split(",").map((e=>e.trim()));for(let e=1;e<t.length;e++){const o=t[e].split(",").map((e=>e.trim().replace(/\r/g,"")));if(o.length===i.length){const e={};for(let t=0;t<i.length;t++)e[i[t]]=o[t];this.dialogueData.push(e)}}console.log("加载的对话数据:",this.dialogueData)}catch(e){console.error("加载 CSV 数据出错:",e)}}onStartButtonClick(){this.node.active=!0,this.dialogueLabel.node.active=!0,this.nextButton.node.active=!0,this.startButton.node.active=!1,this.currentDialogueId=1,this.showDialogue(this.currentDialogueId)}showDialogue(e){console.log(`显示对话 ID: ${e}`),this.currentDialogueId=e;const t=this.dialogueData.find((t=>t.ID===e.toString()));if(t)if(console.log("找到对话数据:",t),this.resetOptionButtons(),"选项"===t.人物)this.nextButton.node.active=!1,this.showChoices(e);else{this.showDialogueWithEffect(t.对话),this.handleNormalDialogue(t);const e=t.图片;this.loadImage(e);const i=t.人物,o=t.位置;this.loadCharacter(i,o)}else console.error("未找到ID为",e,"的对话")}handleNormalDialogue(e){const t={"左":this.leftNameLabel,"右":this.rightNameLabel,"中":this.middleNameLabel};this.leftNameLabel.node.active=!1,this.rightNameLabel.node.active=!1,this.middleNameLabel.node.active=!1,t[e.位置]&&(t[e.位置].node.active=!0,t[e.位置].string=e.人物),"结束"===e.人物&&(this.node.active=!1,this.dialogueLabel.node.active=!1,this.startButton.node.active=!0,this.nextButton.node.active=!1,this.currentDialogueId=1,this.spriteA.node.active=!1,this.spriteB.node.active=!1,this.dialogueImage.node.active=!1,this.switchToNextScene())}showChoices(e){const t=[];let i=e;for(;;){const e=this.dialogueData.find((e=>e.ID===i.toString()));if(!e||"选项"!==e.人物)break;t.push(e),i++}if(t.length>0){this.choicesContainer.active=!0,this.choicesContainer.removeAllChildren(),t.forEach((e=>{const t=u(this.choiceButtonTemplate);t.active=!0,this.choicesContainer.addChild(t);t.getComponentInChildren(a).string=e.对话||"选项";t.getComponent(r).node.on(r.EventType.CLICK,(()=>{this.showDialogue(parseInt(e.跳转)),this.nextButton.node.active=!0}),this)}));this.choicesContainer.getComponent(g)?.updateLayout()}else console.error("未找到选项数据")}resetOptionButtons(){this.choicesContainer.active=!1,this.choicesContainer.removeAllChildren()}onNextDialogue(){if(this.isTyping){this.typingInterval&&(clearInterval(this.typingInterval),this.typingInterval=null);const e=this.dialogueData.find((e=>e.ID===this.currentDialogueId.toString()));e&&(this.dialogueLabel.string=e.对话,this.isTyping=!1)}else{const e=this.dialogueData.find((e=>e.ID===this.currentDialogueId.toString()));e&&e.跳转?this.showDialogue(parseInt(e.跳转)):console.error("未找到对应的下一步对话数据:",this.currentDialogueId)}}showDialogueWithEffect(e){this.dialogueLabel.string="";let t=0;this.isTyping=!0,this.typingInterval&&clearInterval(this.typingInterval),this.typingInterval=setInterval((()=>{t<e.length?(this.dialogueLabel.string+=e.charAt(t),t++):(clearInterval(this.typingInterval),this.typingInterval=null,this.isTyping=!1)}),this.typingSpeed)}loadImage(e){console.log(`加载图片ID: ${e}`);const t=this.imageMapping[e];if(t){const e="dialogue_images/"+t+"/spriteFrame";console.log(`加载图片资源路径: ${e}`),p.load(e,d,((t,i)=>{t?console.error(`加载图片失败: ${e}, 错误: ${t}`):(console.log(`图片加载成功: ${e}`),this.dialogueImage.spriteFrame=i,this.dialogueImage.node.active=!0)}))}else console.error("未找到图片映射: "+e),this.dialogueImage.node.active=!1}loadCharacter(e,t){if(console.log(`加载角色: ${e}, 位置: ${t}`),!e)return console.log("未指定角色名称，隐藏 Sprite A 和 Sprite B"),this.spriteA.node.active=!1,void(this.spriteB.node.active=!1);const i="dialogue_images/"+e+"/spriteFrame";console.log(`加载角色资源路径: ${i}`);let o=null;if("左"===t)o=this.spriteA;else{if("右"!==t)return console.warn(`位置 ${t} 不需要处理立绘，隐藏 Sprite A 和 Sprite B`),this.spriteA.node.active=!1,void(this.spriteB.node.active=!1);o=this.spriteB}p.load(i,d,((e,t)=>{e?(console.error(`加载角色立绘失败: ${i}, 错误: ${e}`),o&&(o.node.active=!1)):(console.log(`角色立绘加载成功: ${i}`),o.spriteFrame=t,o.node.active=!0)})),"左"===t?(console.log("隐藏 Sprite B"),this.spriteB.node.active=!1):"右"===t&&(console.log("隐藏 Sprite A"),this.spriteA.node.active=!1)}switchToNextScene(){const e=m.getScene().name;console.log(`当前场景名称: ${e}`);const t=e.match(/scene(\d+)/i);if(t&&t[1]){let i=parseInt(t[1],10);if(isNaN(i))return void console.error(`无法解析场景编号，从场景名称 "${e}" 中提取数字失败。`);const o=`scene${i+1}`;console.log(`即将加载的新场景名称: ${o}`),m.loadScene(o,(e=>{e?console.error(`加载新场景 "${o}" 失败:`,e):console.log(`成功加载新场景 "${o}"`)}))}else console.error(`当前场景名称 "${e}" 不符合预期格式 "scene<number>"。无法确定下一个场景的名称。`)}}).prototype,"csvAsset",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(z.prototype,"dialogueLabel",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(z.prototype,"leftNameLabel",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=t(z.prototype,"rightNameLabel",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(z.prototype,"middleNameLabel",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(z.prototype,"startButton",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(z.prototype,"nextButton",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(z.prototype,"choicesContainer",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(z.prototype,"choiceButtonTemplate",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(z.prototype,"dialogueImage",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(z.prototype,"spriteA",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(z.prototype,"spriteB",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(z.prototype,"typingSpeed",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),x=z))||x));o._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./debug-view-runtime-control.ts","./CameraFollow.ts","./DialogueManager.ts","./SimpleButtonEffect.ts"],(function(){return{setters:[null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/SimpleButtonEffect.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var o,e,n,s,i,r,u,a,c,l;return{setters:[function(t){o=t.applyDecoratedDescriptor,e=t.initializerDefineProperty},function(t){n=t.cclegacy,s=t.Node,i=t._decorator,r=t.Component,u=t.Vec3,a=t.UIOpacity,c=t.Button,l=t.Tween}],execute:function(){var h,p,d,N,b;n._RF.push({},"aef6114nHxAlYE97p+NEUhu","SimpleButtonEffect",void 0);const{ccclass:E,property:f}=i;t("ButtonEffect",(h=E("ButtonEffect"),p=f(s),h((b=o((N=class extends r{constructor(...t){super(...t),e(this,"buttonNode",b,this),this.originalScale=new u}start(){if(this.buttonNode){this.originalScale=this.buttonNode.scale.clone(),this.buttonNode.getComponent(a)||this.buttonNode.addComponent(a);const t=this.buttonNode.getComponent(c);t&&(t.transition=c.Transition.NONE),this.buttonNode.on(s.EventType.TOUCH_START,this.onButtonPressed,this),this.buttonNode.on(s.EventType.TOUCH_END,this.onButtonReleased,this),this.buttonNode.on(s.EventType.TOUCH_CANCEL,this.onButtonReleased,this),this.buttonNode.on(s.EventType.MOUSE_ENTER,this.onHoverStart,this),this.buttonNode.on(s.EventType.MOUSE_LEAVE,this.onHoverEnd,this)}}onHoverStart(){const t=this.buttonNode.getComponent(a);t&&new l(t).to(.1,{opacity:230}).start()}onHoverEnd(){const t=this.buttonNode.getComponent(a);t&&new l(t).to(.1,{opacity:255}).start()}onButtonPressed(){l.stopAllByTarget(this.buttonNode);const t=this.originalScale.clone().multiplyScalar(.9);new l(this.buttonNode).to(.1,{scale:t}).start()}onButtonReleased(){l.stopAllByTarget(this.buttonNode),new l(this.buttonNode).to(.1,{scale:this.originalScale}).start()}}).prototype,"buttonNode",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=N))||d));n._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});